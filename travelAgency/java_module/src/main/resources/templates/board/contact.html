<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="/layout/head :: headFragment"></th:block>
<body>
<header th:replace="~{layout/header :: headerFragment}"></header>
<nav th:replace="~{layout/nav :: navFragment}"></nav>
<main class="main-content">
    <link href="/css/contact.css" rel="stylesheet">
    <link href="/css/services.css" rel="stylesheet">
    <div style="height: 30px; display: flex; justify-content: flex-end">
        <a href="javascript:window.history.back()">ë’¤ë¡œê°€ê¸°â†©ï¸</a>
    </div>
    <div class="container">
        <aside class="left-nav">
            <div class="nav-section">
                <h3>ì¹´í…Œê³ ë¦¬</h3>
                <div style="border-bottom: 3px solid black;"></div>
                <ul>
                    <li><a th:href="@{/board/contact}">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</a></li>
                    <li><a th:href="@{/board/boardList}">ì§ˆë¬¸ ì „ì²´ ì¡°íšŒ</a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3>ë¹ ë¥¸ ë§í¬</h3>
                <div style="border-bottom: 3px solid black;"></div>
                <ul>
                    <li><a href="#">ì§ˆë¬¸ ë“±ë¡í•˜ê¸°</a></li>
                    <li><a th:href="@{/board/boardList(searchType=userId)}">ë‚´ ì§ˆë¬¸ ë‚´ì—­ ë³´ê¸°</a></li>
                </ul>
            </div>
        </aside>
        <section class="content">
            <h2>ğŸ” ê¶ê¸ˆí•œ ì ì€ ê²€ìƒ‰ìœ¼ë¡œ ì‰½ê³  ë¹ ë¥´ê²Œ í™•ì¸í•˜ì„¸ìš”.</h2>
            <div class="search-bar">
                <form id="searchForm" th:action="@{/board/boardList}" method="get">
                    <select name="searchType" id="searchType" required>
                        <option value="">êµ¬ë¶„</option>
                        <option value="title" th:selected="${searchType == 'title'}">ì œëª©</option>
                        <option value="content" th:selected="${searchType == 'content'}">ë‚´ìš©</option>
                    </select>
                    <input type="text" id="keyword" name="keyword" th:value="${keyword}" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”." required>
                    <button type="submit">ê²€ìƒ‰</button>
                </form>
            </div>
            <div class="notice" style="font-size: large; background-color: aliceblue; padding: 10px;">
                <a><strong>ğŸš¨ê³µì§€ </strong> [ì•ˆë‚´] ì‚¬ì´íŠ¸ ì ê²€ ì•ˆë‚´ 4/1</a>
            </div>

            <div class="keywords">
                <a href="#">ì„œë¹„ìŠ¤ ì´ìš©</a>
                <a href="#">ì¶œì¥ ì¤€ë¹„</a>
                <a href="#">ê²°ì œ/í™˜ë¶ˆ</a>
                <a href="#">ì¶œì¥ ê´€ë¦¬</a>
                <a href="#">ê²¬ì  ë¬¸ì˜</a>
                <a href="#">íšŒì›ê°€ì…</a>
            </div>
            <h2>â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ FAQ</h2>
            <div class="accordion">
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>Q. ê²¬ì  ë¬¸ì˜ëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?</h3>
                        <span class="accordion-icon"><img src="/images/company/right-arrow.png"></span>
                    </div>
                    <div class="accordion-content">
                        <p>ê²¬ì  ë¬¸ì˜ëŠ” ìƒë‹¨ 'ê²¬ì  ë¬¸ì˜í•˜ê¸°' ë²„íŠ¼ì„ í†µí•´ ì‹ ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>Q. ì¶œì¥ ê´€ë¦¬ ë§¤ë‰´ì–¼ì´ ìˆë‚˜ìš”?</h3>
                        <span class="accordion-icon"><img src="/images/company/right-arrow.png"></span>
                    </div>
                    <div class="accordion-content">
                        <p>ë„¤, íšŒì›ê°€ì… í›„ ë§ˆì´í˜ì´ì§€ì—ì„œ ì¶œì¥ ë§¤ë‰´ì–¼ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>Q. íšŒì›ê°€ì…ì´ í•„ìˆ˜ì¸ê°€ìš”?</h3>
                        <span class="accordion-icon"><img src="/images/company/right-arrow.png"></span>
                    </div>
                    <div class="accordion-content">
                        <p> ì˜ˆì•½ ë° ê²°ì œëŠ” íšŒì›ê°€ì… í›„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
            <table id="readResults">
                <h2>ğŸ—‚ï¸ ê°€ì¥ ë§ì´ ì¡°íšŒëœ ì§ˆë¬¸ TOP5</h2>
                <thead>
                <tr>
                    <th>ë²ˆí˜¸</th>
                    <th>ì œëª©</th>
                    <th>ë‚´ìš©</th>
                    <th>ì¡°íšŒìˆ˜</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="board, stat : ${boardList}" style="text-align: center;">
                    <td name="stat" th:text="${stat.index+1}"></td> <!-- ì—­ìˆœ -->
                    <td name="title"><a th:href="@{/board/boardDetail(BOARD_ID=${board.BOARD_ID})}"><span th:text="${board.BOARD_TITLE}"></span></a></td>
                    <td name="content" th:text="${board.BOARD_CONTENT}"></td>
                    <td name="hits" th:text="${board.BOARD_HITS}"></td>
                </tr>
                </tbody>
            </table>
            <div class="search-result-count" style="text-align: right"><span th:text="${'ì´ ê²Œì‹œê¸€ : '+totalBoardCount}"></span></div>
            <button class="pretty-button" type="button" id="boardList" style="width: 100%;margin: 2em 0; padding: 1rem;}">ì „ì²´ ë³´ê¸°</button>
        </section>
    </div>
</main>
<footer th:replace="~{layout/footer :: footerFragment}"></footer>
<script>
    $(document).ready(function () {

        window.onpageshow = function(event) {
            if (event.persisted) {
                window.location.reload();
            }
        };

        // ì „ì²´ ê²Œì‹œíŒìœ¼ë¡œ ì´ë™
       $('#boardList').click(function (e) {
            location.replace("/board/boardList");
       });

        var count = 0;

        // FAQ ì•„ì½”ë””ì–¸
        $('.accordion-icon').click(function () {
            if(count == 0){
                $(this).closest('div').siblings('div').show();
                count++;
            }else{
                $(this).closest('div').siblings('div').hide();
                count = 0;
            }
        });

        hashTag();

        // í‚¤ì›Œë“œ ê²€ìƒ‰ì²˜ë¦¬
        $('.keywords').find('a').click(function (e) {
            var tag = e.target.textContent;
            var txt = tag.replace('#','');
            $('.search-bar').find('input').val(txt);
            // ì—¬ê¸°ì„œ ë°”ë¡œ í´ë¦­ í˜¸ì¶œí•˜ë©´ Maximum call stack size exceeded
        });

        $('#boardList').click(function (e) {
            location.replace("/board/boardList");
        });

        // í•´ì‹œíƒœê·¸ # ì¶”ê°€
        function hashTag() {
            for(var i=0;i<$('.keywords').find('a').length;i++){
                var keywordTxt = $('.keywords').find('a')[i].text;
                $('.keywords').find('a')[i].text = '#'+keywordTxt;
            }
        }

        // ì •ë ¬
        function submitSort(type) {
            $('#sortTypeInput').val(type);
            $('.sort form').submit();
        }

        // ì—”í„°í‚¤ê°€ ëˆŒë ¸ì„ ë•Œ ì‹¤í–‰í•˜ëŠ” ë°˜ì‘
        function enterkey() {
            if(searchType == '' || keyword == ''){
                alert('ê²€ìƒ‰êµ¬ë¶„ í˜¹ì€ ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            if (window.event.keyCode == 13) {
                $("#searchForm").submit();
            }
        }

        $('#searchForm').submit(function(event) {
            event.preventDefault();

            var keyword = $('#keyword').val().trim();

            $.ajax({
                url: '/api/boardList',
                type: 'GET',
                dataType: 'json',
                data: { keyword: keyword },
                success: function(data) {
                    var html = '';
                    if (data && data.length > 0) {
                        $.each(data, function(index, board) {
                            html += '<tr>';
                            html += '<td>' + (index + 1) + '</td>';
                            html += '<td>' + board.board_TITLE + '</td>';
                            html += '<td>' + board.board_CONTENT + '</td>';
                            html += '</tr>';
                        });
                        $('#readResults tbody').empty().append(html);
                        $('#searchResults').empty();
                        $('#keyword').val("");
                    } else {
                        $('#searchResults').html('<p class="no-data">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>');
                        $('#readResults tbody').empty();
                        $('#keyword').val("");
                    }
                },
                error: function(xhr, status, error) {
                    console.error('ê²€ìƒ‰ ìš”ì²­ ì‹¤íŒ¨:', error);
                    alert('ê²€ìƒ‰ ì—ëŸ¬!');
                    $('#keyword').val("");
                }
            });
        });



    });
</script>
</body>
</html>