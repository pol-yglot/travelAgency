<!DOCTYPE html>
<html lang="ko">
<th:block th:replace="~{/layout/head :: headFragment}"></th:block>
<body>
<header th:replace="~{layout/header :: headerFragment}"></header>
<nav th:replace="~{layout/nav :: navFragment}"></nav>
<main class="main-content">
    <link href="/css/profile.css" rel="stylesheet">
    <section class="profile">
        <div class="profile-header">
            <div class="profile-background"></div>
            <div class="profile-avatar">
                <div class="profile-info">
                    <h2 th:text="${user.USER_NAME} + 'ë‹˜, ì•ˆë…•í•˜ì„¸ìš”! :)'"></h2>
                    <p th:text="${user.USER_EMAIL}"></p>
                </div>
                <!--<img th:src="${userDetail.USER_PROFILE_IMAGE_URL}" alt="í”„ë¡œí•„ ì‚¬ì§„">-->
                <img id="profile-avatar" th:src="${userDetail.USER_PROFILE_IMAGE_URL}" alt="í”„ë¡œí•„ ì‚¬ì§„" style="cursor:pointer;" />
            </div>
        </div>

        <div class="profile-content">
            <!--<div class="profile-section">
                <h3>ê´€ì‹¬ë¶„ì•¼</h3>
                <input type="hidden" id="preferenceJson" name="preferenceJson">
                <p class="preference" id="preference"></p>
            </div>-->

            <div class="profile-section">
                <a href="/user/updateProfile" class="long_btn"  id="edit-profile-button">í”„ë¡œí•„ ìˆ˜ì •</a>
                <a href="/user/dashboard" class="long_btn"  id="dashboard">ëŒ€ì‹œë³´ë“œ</a>
                <a href="/user/signout" class="long_btn"  id="signout">íšŒì›íƒˆí‡´</a>
            </div>


        </div>
    </section>
</main>
<!-- ëª¨ë‹¬ ë°°ê²½ -->
<div id="preferenceModalOverlay" class="modal-overlay"></div>

<!-- ëª¨ë‹¬ ë³¸ì²´ -->
<div id="preferenceModal" class="modal">
    <button class="close-button" id="closeModal">&times;</button>
    <h3>ê´€ì‹¬ ë¶„ì•¼ ì„ íƒ</h3>

    <label for="modal_travelStyle">ì—¬í–‰ ìŠ¤íƒ€ì¼</label>
    <select id="modal_travelStyle">
        <option value="íŒ¨í‚¤ì§€ ì—¬í–‰">íŒ¨í‚¤ì§€ ì—¬í–‰</option>
        <option value="ììœ  ì—¬í–‰">ììœ  ì—¬í–‰</option>
    </select>

    <label for="modal_accommodationType">ìˆ™ì†Œ ìœ í˜•</label>
    <select id="modal_accommodationType">
        <option value="ë¦¬ì¡°íŠ¸">ë¦¬ì¡°íŠ¸</option>
        <option value="í˜¸í…”">í˜¸í…”</option>
    </select>

    <div class="modal-footer">
        <button class="btn btn-save" id="savePreference">ì €ì¥</button>
        <button class="btn btn-cancel" id="closeModal2">ì·¨ì†Œ</button>
    </div>
</div>

<!-- ğŸ‘‡ í™•ëŒ€ ë³´ê¸°ìš© ëª¨ë‹¬ -->
<div id="avatar-container" class="avatar-modal">
    <div class="avatar-modal-overlay" id="avatar-overlay"></div>
    <div class="avatar-modal-content">
        <span class="avatar-close" id="avatar-close">&times;</span>
        <img id="avatar-large" src="" alt="í”„ë¡œí•„ í™•ëŒ€ ì´ë¯¸ì§€">
    </div>
</div>


<footer th:replace="~{layout/footer :: footerFragment}"></footer>
<script>
    $(function () {

        $('#edit-profile-button').click(function () {
            location.replace("/user/updateProfile");
        });

        // ë²„íŠ¼ ì‚½ì…
        $("#preference").html(`
          <button type="button" class="pretty-button" id="openPreferenceModal">
            ê´€ì‹¬ë¶„ì•¼ ë“±ë¡
          </button>
        `);

        // ëª¨ë‹¬ ì—´ê¸°
        $('#preference').on('click', '#openPreferenceModal', function () {
            $('#preferenceModal').fadeIn(200);
            $('#preferenceModalOverlay').fadeIn(200);
        });

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            $('#preferenceModal').fadeOut(200);
            $('#preferenceModalOverlay').fadeOut(200);
        }

        $('#closeModal, #closeModal2, #preferenceModalOverlay').click(closeModal);

        $('#profile-avatar').on('click', function () {
            const src = $(this).attr('src');
            $('#avatar-large').attr('src', src);
            $('#avatar-container').fadeIn(200);
        });

        $('#avatar-overlay, #avatar-close').on('click', function () {
            $('#avatar-container').fadeOut(200);
        });

    });
</script>
</body>
</html>